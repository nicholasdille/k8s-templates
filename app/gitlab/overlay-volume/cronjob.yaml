#@overlay/match by=overlay.and_op(overlay.subset({"kind": "CronJob"}), overlay.subset({"metadata": {"name": "db"}})),expects="1+"
---
spec:
  jobTemplate:
    spec:
      template:
        spec:
          #@overlay/match missing_ok=True
          volumes:
          #@overlay/match by="name",missing_ok=True
          - name: db
            persistentVolumeClaim:
              claimName: gitlab
          containers:
          #@overlay/match by="name"
          - name: main
            #@overlay/match missing_ok=True
            volumeMounts:
            #@overlay/match by="name",missing_ok=True
            - name: db
              mountPath: "/var/lib/postgresql/data"
              subPath: db-data
